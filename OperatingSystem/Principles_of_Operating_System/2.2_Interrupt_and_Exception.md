# 中断与异常机制 - OS的驱动力

中断/异常机制 - 现代计算机系统的核心机制 

好比：汽车发动机，飞机引擎

主要作用
1. 及时处理设备发来的 中断请求
2. 使OS捕获用户程序提出的服务请求
3. 防止用户程序执行过程中的破坏性活动

## 1 概念
* CPU对系统发生的**某个事件**作出的一种反应
* CPU暂停正在执行的程序，保留现场后**自动转去**执行相应事件的处理程序，处理完成后返回断电，继续执行被打断的程序

特点：随机发生，自动处理，可恢复


| 中断 - 外部事件，正在运行的程序所不期望的 |   |   |
| --- | --- | --- |
|  | I/O中断 | Ctrl+C,打印结束 |
|  | 时钟中断 | CPU设置事件片到时 |
|  | 硬件故障 | 笔记本电池耗尽 |
|  |  |  |
| 异常 - 由正在执行的指令引发 |  |  |
|  | 系统调用 |  |
|  | 页故障/页错误 |  |
|  | 保护性异常 |  |
|  | 断电指令 |  |
|  | 算术溢出 |  |

![](http://ww3.sinaimg.cn/large/006tNc79gy1g3rfnn30t1j30qo0k0dhk.jpg)



## 2 工作原理

* 硬件做什么？
捕获中断源发出的中断/异常请求，
以一定的方式响应，
将处理器控制权交给特定的处理程序

* 软件做什么？
识别中断/异常类型
完成处理

![](http://ww1.sinaimg.cn/large/006tNc79gy1g3rftytz53j31430u01ky.jpg)

![](http://ww3.sinaimg.cn/large/006tNc79gy1g3rfw6jmvwj313s0u0u0x.jpg)

设计操作系统时，会为每一类 中断/异常 事件编好相应的处理程序，并设置好中断向量表

### 2.1 X86处理器 对 中断/异常 的支持
![](http://ww1.sinaimg.cn/large/006tNc79gy1g3rg2tnhtfj30zw0r8td6.jpg)

